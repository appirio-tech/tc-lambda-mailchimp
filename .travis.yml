language: node_js
node_js:
- '4.3'
install:
- npm install
before_script:
- chmod +x deploy.sh
sudo: false
deploy:
- provider: script
  skip_cleanup: true
  script: "./deploy.sh"
  on:
    branch: preferences
- provider: script
  skip_cleanup: true
  script: "./deploy.sh"
  on:
    branch: dev
- provider: script
  skip_cleanup: true
  script: "./deploy.sh"
  on:
    branch: release
- provider: script
  skip_cleanup: true
  script: "./deploy.sh"
  on:
    branch: master
env:
  matrix:
  - CXX=g++-4.8
  global:
  # DEV_AWS_KEY
  - secure: hDA7g7jYdBkFyLcRyHJL6hvZS1Rvh5d0yzzC4Hi+j5r1HYg7cqnAs4VwEhEV7Y4C9FBvDK43YXtQuQ8GSTYXVjJQQwgcJ+efHihKCfIrtSOW4x2WEZx2BhoiSAv3QkS/Krq8VEd/Zgf/OuKJjUqQUe4cLZurcCNqWc8DB9Ytbtr7RM8ozn/O5KN9l91/wBMUNZrwvUp8ro6SXlUUAzRritu+hhACUmoY5a5kxqgvMZPuzIurmj4z1mq7nyYKk+Sj4NQ6pQD3gd2vU2OEfKxsPDDLjPSCnObrCWtdBya/jzpPjCIWnTxgakSWQa6g6386ToRa8eZGi4DCKTvKfR3IucOSb2yNccVVY/xHsmnazmpSb2wNhIvnK5Q5SpTYMMPWmJdz9dlxT0spo3LFO5DYlHNuUPtV9gq+TzoUWIVVT67MhFBYoOEU7aRxGBLr3YNonKH6kWwmTRT/5y9V+X2AK9YPw55Ft5kw3mX4n8AzOOmsi+nAC07xvMSpzOTFuTaVr+QemvCV13kbAHCN4Xt+h06KjK3ceMpXabL2VbuJPwXp0sbFE4WGaok2MMBSmB58Hcovwqs7OEOIKqAJEWsTXp3DyJxbPZ9twtqZMj5gK+TEgRObkD4F5QbRbAJKoJbvBj8X1C/NaOxt9KsH1/dGn1ISrjvDckAibt4LyqL7n8M=
  # DEV_AWS_SECRET
  - secure: evHyyqlB/lgx9lHr7gfcMI3zabOSoLi06A2KbIPfm1ynTupIdVf/oKNHy4S95WEcHWFKBmcOljvdoSU4cWvGUgbVAXgPgOihnmwUDa3rwus12FxACKpnZZCktGm/azgYTZjo3jzyWQkpgD2o341wvPKhK+DsplnP5Kg6PFpLKyyUPkpWxe2BP/X0fOu3P1Nv9L/sYykA6Uy6dCMqTy6YJeUL3qdfrzXbryzcjY76/dES1ztJSMqpU0YBJct9m5tCCy2AzyCGvQujA17JnTackMigtz+EPr8rQByPtLvh79vEPtnn6iad7ZL8es+Lf6FIiJkS9qlGZDifqhSa7CL57iSyAbV28Vk43Kv9Vt+RIG2dqRw/t0faszz278kMmgZFwe3lCsvlVcLACYx0GMcXYIJwLK8/Ct7FNVwuBkdaGRJLdKg3WeI9PNBfBl/Ri7sp4buAmA4IeBCpygUihxL8HALU9tTGx3n/tkn0p7VZnknZ/zndg7SghCW68L7Mcfpca3y2EOOUQ4I9mT/sLv5vJ7aSSEk0jTiC0NQEIYfaw5rZMENwHPjsj+mdcVw9EeTVY8WNsYZPhhecAaqzPT4IkD4M59ur7C58iLGrKVPbTi5ywz01Cis+5Nj480mAFkvJc+hSGLa5VqrFI8GUD+95Z9JwzD1/BKCZjCvCrUOiN2I=
  # DEV_AWS_LAMBDA_ROLE_ARN
  - secure: MgrHW/Hdyf3NdBKQpQaYJaOd4hUe++RrudEHnimmCoB63VVUlpbwklgAvwm2oG+VmlXdbqzNB0A4idYIkRXczc8/XHammshQIvMFK3eYesMkHnmXRfNoA5OnKPu5p05u276izFTEVH1oPgE0Q/R9Ltp2LRe5If8Mj2+1J+uc4j6N8TBw8+SdB9X+8HdbU8RVmjVFuuX/mmBOSONxlpwqDJ0ER5iMiTPuUN2d8c6r3bVzgzyl3tJFqJAXUOdvUfvONvtTw/wfXw3QF0/2J+V2F9zfTCy4e3pul2TU/IqkyPJdPnboPoMJ+RwOX+UUA7Wu5FOQdcdQfQhyi/TDOQx8vkuvv/W4GGSkdeIt8vkWQ4tCUS7v88qXY16TpVFUhar2TJMmaGD/WR26vIK8EM7X+Kytr6mZGPKJ0TjspxIj5l3j1Jl5+Cm7B5gutG7lRK4xrcr0klzQ3NYIqB9lxd0hCJR9fAfKKP9Keuee+PhVe9GIOWQIs/PluFO+mK4uYVaVFAT4P8n48W/QoxN3MyFbQMtebEGRyXF4pis7sDUq6DuwYcqubndy68xEqMe/1ATgakJ1hmBEURExw2RtQ2I5QOEZo+R8YNnZLqw9L1X7um6DTAOT9fQE5xYJVM9En2uwNaNhn75MofL7LZxwEg3vamAnUyMAuX1lxm0xQi+p/qg=
  # DEV_MAILCHIMP_API_KEY
  - secure: DRsiyqloHILeTc6/Yknzfrb5VvVqdtmNASqmX5zShebtZ7gOWBolr23/CcSWpSA47LFPFQjPfUgl0YdH2bP+0grIArah/tgph+4eEd7kNqNpXrSKHNHVJGcUyzcWjlwYQjzpKyrXu/ZCBYhYHQTiAaU1ZE56qVVk9gR0QvGticNJLaUYWxz2w3PKhaAwv6FtIxL1C09pEgEEp3Zn4HFgQ1+xOIhH1+0OyqTCzbCRIIaUidksySyuU7nDGeJ0eCmEA4D0ZJ2oKJIgVVovKArsHO+28TUt0fZjwNU+RXhYpvCsWTPq+/NJ53nIjN6qpSIw+4a0sRtX4+ygNCriC/i5wlpwgliyAIH/vEiFmrimVvlaM9euUOFYomvdHOyxd0nVlnSg54Q0PtADnHh6QoUcfWPFrmRuvj2jINrcU1xVH8q0ctD/3d9KARuOHcHqGNeAMl9/LLmzUU/IAvTAOvM1YTKhogF9M5Mopyvb2sLdSPMv0E6Uc5Fj6iGTl03eXybEZLCI8P6mQUfPjAbRd/vPTTZxexVJ6QsskGqCU1KA/tdRfPJ5nBxIxyPqKa/SsMsoW8MxpdIYQ4mXTfX+64Eo43rh6kSD87euKtcIY6nLpAaOTkHQHIM27iLnoLoDsEABSrIHlwb6TX7tGMAehDbwy/RtuEiU5ucUnwR95CgVYlE=
  # QA_AWS_KEY
  - secure: iUTgcjeYndowuBPxETSl/1Fzec1x5xaDV/pJhZ2/nWJOmzXTyaDlMMjBWx1xxJmOF9rR8YgCFEm4ewOlInqv2hBPYk/OQn0EUDnBxobDH8Lgk8y9C+FWayWJ7Az1dgovCUUpOQ3Kj/fiFTH08/NyfYRgqjKSvt5smTJOpotUSmeof3lzK+mufotDJS4UcAgjdXxqjlB6+mhBTPW+8MexioLJCKWyhE4WYxfP5XGJ1l9S8qDHHep1mBKKkgjS6gyV6eJ7ZAtDqBkspjaB8K9bBMFa7xASnGoH7+WQ4tNnV8ykQTdI+wwvEtFNkor6flFffMsW1JX3UHl4GRR9hlMMr+eWmIcXSoLgWaZWdRbEc2s2C4SVxvYI3P77KfDiQJ//fNQb9p5nybtDgwCMUj8bFC4SAmQJ9r25zbz/BAY7da4KWBDfbJvabiWh0fmsCr3YHIpHKVGngahHDFJZAZWkwjQnphsZ+PGcL42PJPnqkYkGYJlyx6V/F9y0bLfUMLBm0v7jIyfbrOqYC7B0qxFaUh6p03A9/zJF99FLilPKWrrWqvuaPsrVWGhvJpAg/9Y7GqsZDo765nC4FQpE2vwNXYyODRF6MPTOSWWGWjeXvW2dmh49cFnpCoVwWaSEqxsPij8pxQ64tFvDIDgtbYQoSUWnpjG3E1v9x8YRZxScoR4=
  # QA_AWS_SECRET
  - secure: KI4eZQltIUL8R/s4K7MECxP4SmwJ+KKLwt1QHpM73eIHaNCTBpgOcjt5/J8GPFlqUOyJ6BYb/OLWCbsW3iOcq9dnYL2+dbY1uZREZNL0NmQqTqkwQAWOHma/21g4JuHg3lz203WkrR91NwCyP21mc3JwoOfvx0pyxZ0cRPOo9jgBsaAFmYhPQSIpc9Zs5UjK5vaCGTkxgRlMFA+t2IS0f3UcuRcS4FX98raITgn2PtepcYJUX5e/4coTR5UTZ+4gBcd22O6ki6QqUvZz9+e/7W7+X/Pd6YZJJXJXVNHcnqcgismykrAFPnTRdNk80deqOLCnEDfWv/HSbuvJam8hHTqA6gA6osbCNEcEQu+e5J2DKxGZ0e+F+cZ+f+epaHSXYlayVFLkOgQWQxRfF2bSM9GBUV8Kdj+GvbVc2iqAO7UNbodLiX4N3yf4bUzPZI0o3cNUeQRZ4SDeOwsy1zliniEmFhSsGEetsLp2mEcmDZ0a1CfNaHC+8fkjI3C1G4gZsklL4A89J18raywpFPvS/u5T78+8J5P0yNpkRxr8bTi/JZPH2iVzWECQf3cwudK6AmR7pmYeBI43Aqv96ONa22tIJyBxzw54kbAYna6h3NybrDuE7ipwr1A4Ob1KtcFGmXLkazuz/jhDMtTyBK6p+UodNuvZlTdJtPrr6g1olss=
  # QA_AWS_LAMBDA_ROLE_ARN
  - secure: q1qXbxXhEfrVCyjWs413sEn8xrDCdx3520VRpcOiFBvZysfZvyckEGopzHerwWaXfKP2DqNRlpjt/IX4KvQPfx7KWFo5+t2ZfqAQtg37mc0f58WNgVsevXaDXPO7sT+l3SUUbia3T5+zA2x5FOvG5g1ig6Ri8iR51khshBAqcwQcs4A8EeDYtEncfhuSZllcol5eXCMlnpRpPYn2tU0Uot7IQbip18ohxAF3WHZ0PT7VOwP7+yPVbU67BzBFG0ypTbj2r/6YUMQ3v1esEKkdL4lmtA5IJ6EfSU4D3qZF9Wf7aav5UW+5nbTzKXaAnhC0ZfdZ4awM7hte3RrdZfi0blpVlOfZrDfRRUVk8Yfvkwnaj0fp7xWJ2tScrumZQTm9BVgovGPFb+tCaCuwp/f4YDJx87Qs6L28rOJQ1YZn9yKhamrQMmFXqeAfgNp8RTsjE997DP10qWI0xSQXo92eeNfdxYwF/DoluGkiN4oklfES+vLsSzs7qUOzJPrVyXR7qndoihDkxWPrO9JTasxfs9/kJo1c3f9VlLsibYMi8b/4lrNueLMq97xXTQZabGRzGurqvhshAFslesbNMpWOyTMYZNZ8CIXbJ8pwI24JMp80wjdBU0Px+XKRcNeNtDEpzUPxVfBhpDMhVv2oY1Q0fAxvfd962/6/4hrGG61lGl4=
  # QA_MAILCHIMP_API_KEY
  - secure: bVjbaYjiZT/RkTF+ictuwk5APRJVsXzCpNmvMVyD2UokMXQYzJ0zuKHkV0ro0YKKpXJiwTdNY7Np0hbHufVoYbE38Yvg4FwgPaHVxVOS8Nhhj3M+TMho01eLgTsDwjx6jMHKU1dDNqNeQ6hmOkMtbiqWluEcbUTrbsZawC5mK0IZUrYFrPF02gxFxrZAEI20TneZSvPxFyrATqWUuxM3CpLxLEFoWMgBKxVqrs4g3dR4jmb6kNoma2it4YCauog0chh2hBkY2qIDs447NlbvffcyCHgCanNKkcr1XECOjdXBzBcC9SBs+x7rAGFNQuHGlNO+3OYa1PhPA/5VekGRbPMMY0UxdI3gFSSrnbT56XO3nBlTnzbk3s/69QbChF31WAGmrC16X9JvNcRMoXtPIwvED/WDidrbOkNMSYOG3ZMRPDK+1Q5qeDgZQi/t0jumDbyiohj+r62yyjC5U32ei/02ZS0HF4EgbQXiUUbBCeh9UnylIu1coEznBbm9Edf1J+mb/UAImMbXpxKjG/QMJkuKrQVCQgxDYORmaoosSgLfrG0UpZrQEs1vP5+uonfSv/qYIgMz6kUOJxz4olw7NmBT87sd4s9mr5GQG/iaxDpWgKu77v4AO/JKvFpJI+CFU0QjqgwDSHCWeFAX8y2l3txj2KaMBg3szy1ZQVKc8+o=
notifications:
  slack:
    secure: PMGlpdBoRzMlIjCsPWdXJ1wf550b+mpX0x44ggGWNL7ErpNebfyqIbXf4VJXYQDmhVJt31ygDaxTtj8XwZJlbvQjE6WGHU26KvL/efGJJL5EmgFD8LDBFpsbn49PyoZuVOTbSzqP8d8WCCPo4oBvX2r2Q2Ixh/tUx7i4Bcv0XwNpWAR75v1Yq/NftEI48k2GcI3oHqmuEgLHdP93k1rCUM4sBsgkr4PCltZfoE2AWlF6wY59w/oFiKj4FwycY8QjJZa/zbSQq1B/9QD7n4YBY4QjVv3LmjshEiQv1HGo2rNLV+/BB5ZoQ6JEH9h+seduHNTF+mkToKbJ2YjDERLlqLFYWVQKXTqFkSdYuknguJ3uOfXFaGtPDSqTRljE6WW6UDIJi9lDpxFHjH2q848/2O03RKtYeFKJWNbVb7Q2PWTBFxx6OurYra+tbUAorQiYmAQxd0vJY+qzGIDJZIQ8yDE4C10heOhfRyU8wJSKF3xJUKKWVGfBuHivFBZOETFSg0uVBcJnsXRcErvEQz0LuKaZfP81bIokcKUGxum/xyp9mYhYqWDvIj31RUhDMiRxXTPe9PhW0mlOtRG7tm2+8G08exHPSfONSV2IPUtlQt4j2/+I22ncOwtsm6yZzXXbDjoMR2sCHIyJj3lVECOqAnCfNJ6Q0CNJ93LqxKSHdFU=
